{% include 'admin/a_header.html' %}

    <link rel='stylesheet' type='text/css' href='../../static/admin/css/a_index.css' />
    <link rel='stylesheet' type='text/css' href='../../static/admin/css/a_manage.css' />
	<link href="../../static/admin/css/popup-box.css" rel="stylesheet" type="text/css" media="all" /> <!-- popup box css -->

    <div class="layout_m_content">
        <div class="layout_m_contitle">Manage User</div>
            <table class="layout_m_table1" border="0" cellspacing="" cellpadding="">
                <tr>
                    <td>username:</td>
                    <td><input type="text" class="layout_m_infotext1" id="username" value="{{username}}" /></td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <div class="layout_button_layer"><a href="#" onclick="reSet()" class="layout_button1">reset</a></div>
                    </td>
                    <td></td>
                    <td>
                        <div class="layout_button_layer"><a href="#" onclick="searchUser()" class="layout_button1">search</a></div>
                    </td>
                    <td></td>

                </tr>
            </table>
            <table class="layout_m_table">
					<thead>
						<tr>
							<th>
								<p>userid</p>
							</th>
							<th>
								<p>username</p>
							</th>
							<th>
								<p>location</p>
							</th>
							<th>
								<p>telephone</p>
							</th>
							<th>
								<p>money</p>
							</th>
							<th>
								<p>operations</p>
							</th>
						</tr>
					</thead>
					<tbody>
					{% for user in users %}
						<tr id="{{user.id}}">
							<td>
								<p>{{user.id}}</p>
							</td>
							<td>
								<p>{{user.username}}</p>
							</td>
							<td>
								<p>{{user.location}}</p>
							</td>
							<td>
								<p>{{user.telephone}}</p>
							</td>
							<td>
								<p>{{user.money}}</p>
							</td>
							<td>
								<p>  <a href="#"  onclick="recharge({{user.id}},'{{user.username}}','{{user.telephone}}','{{user.money}}')">Recharge</a></p>
								<p><a href="#">Delete</a></p>
								<p> <a href="#small-dialog2" class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s">Change Information</a></p>
							</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>


{% if totalCount %}
 	<div class='pagin' style="height:40px">
		<div class='message'>total <i class='blue'>{{totalCount}}</i>datas,<i class='blue'>{{totalPageNum}}</i>pages,now<i class='blue'>no.{{pageNum}}&nbsp;</i>page</div>
		<ul class='paginList'>
			{% if pageNum > 1%}
			<li class='paginItem'><a href = 'javascript:;'  onclick='changePage({{pagePre}})' > <img  src='../../static/admin/img/pre.gif' ></a></li>
			{%endif%}
			 {% for page in pages %}
				 {%if page == pageNum%}
					<li class='paginItem current'><a href = 'javascript:;' > {{page}} </a></li>
				 {%else%}
					 <li class='paginItem'><a href = 'javascript:;' onclick='changePage({{page}})'>{{page}}</a></li>
				 {%endif%}
			 {%endfor%}
			{% if pageNum != totalPageNum%}
			<li class='paginItem'><a href = 'javascript:;' onclick='changePage({{pageNext}})'><img  src='../../static/admin/img/next.gif'></a></li>
			{%endif%}
		</ul>
	</div>
{%endif%}
</div>



    <!-- recharge form popup-->
    <div class="pop-up1">
        <div id="small-dialog1" class="mfp-hide book-form">
            <div class="login-form login-form-left">
                <div class="agile-row">
                    <p><h3>Recharge</h3></p>
                    <div class="login-agileits-top">
                        <form action="" method="post">
							<input type="hidden" id="rechargeUserid">
							<p><h2 id="email"></h2></p>
							<p><h2 id="telephone"></h2></p>
							<input type="hidden" id="oldMoney">
							<p><h2 id="money"> </h2></p>
							<input type="text" class="phone" name="phone" value="" id="rechareMoney" Placeholder="Recharge Money" required="" />
                            <input type="button" onclick="rechargeUser()" value="Recharge">
                        </form>
                    </div>
                </div>
            </div>
		</div>
	</div>
	<!-- end recharge form popup-->

	<!-- changePass form popup-->
    <div class="pop-up2">
        <div id="small-dialog2" class="mfp-hide book-form">
            <div class="login-form login-form-left">
                <div class="agile-row">
                    <h3>Change Password</h3>
                    <div class="login-agileits-top">
                        <form action="" method="post">
                            <input type="email" class="email" name="email" id="newEmail" Placeholder="new username/email" required="" />
                            <input type="text" class="phone" name="phone" id="newTelephone" Placeholder="new telephone" required="" />
                            <input type="password" class="password" name="newPassword" id="newPassword" Placeholder="new password" required="" />
                            <input type="button" onclick="subregister()" value="注册">
                        </form>
                    </div>
                </div>
            </div>
		</div>
	</div>
	<!-- end changePass form popup-->


				<a href="#small-dialog1" id="recharge"class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s"></a>
				<a href="#small-dialog2" id="changeInformation" class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s"></a>
    <!--popup-js-->
		<script type="text/javascript" src="../../static/admin/js/jquery-2.1.4.min.js"></script>
		<script src="../../static/admin/js/jquery.magnific-popup.js" type="text/javascript"></script>
		<script>
			$(document).ready(function () {
				$('.popup-with-zoom-anim').magnificPopup({
					type: 'inline',
					fixedContentPos: false,
					fixedBgPos: true,
					overflowY: 'auto',
					closeBtnInside: true,
					preloader: false,
					midClick: true,
					removalDelay: 300,
					mainClass: 'my-mfp-zoom-in'
				});

			});



			function recharge(id,email,telephone,money){
				$("#rechargeUserid").val(id);
				email = "username:"+email;
				$("#email").html(email);
				telephone = "user telephone:"+telephone;
				$("#telephone").html(telephone);
				$("#oldMoney").val(money);
				money = "now money:" + money
				$("#money").html(money);
				$("#recharge").click();
			}

			function rechargeUser(){
				id = $("#rechargeUserid").val();
				money = $("#oldMoney").val();
				rechareMoney = $("#rechareMoney").val()
				$.ajax({
					url:"/a_manage_user/rechareMoney",
					type:"POST",
					data:{
						id:id,
						money:money,
						rechareMoney:rechareMoney
					},
					success:function(data){
						if(data == "success"){
							alert("recharge successfully")

							window.location.href = "../a_manage_user/index"
						}
						else{
							alert("error")
						}
					},
					fail:function(data){
						alert("error")
					}
				})

			}
		</script>

		<script>
			function changePage(page){
				window.location.href = "../a_manage_user/index?pageNum="+page
			}
			function searchUser(){
				username = $("#username").val()
				if(username == ""|username == null)
				{
					alert("please input real username")
					return;
				}
				window.location.href = "../a_manage_user/index?username="+username
			}
			function reSet(){
				window.location.href = "../a_manage_user/index?pageNum=1&&isSet=true"
			}

		</script>

<!--{% include 'admin/a_foot.html' %}-->